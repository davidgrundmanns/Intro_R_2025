---
title: "Intro to R. Session 5: Solutions to bonus exercise"
output:
  html_notebook:
    toc: TRUE
    code_folding: "none"
editor_options: 
  markdown: 
    wrap: sentence
---

### Bonus Exercise 5: Writing your own function

First, generate a set of test scores using the following chunk:

```{r}
# First, we set a seed. This guarantees that we can replicate "random" number generations, i.e., a "random" process is the same every time we run it
set.seed(1701)

# Next, we randomly draw 300 values from a normal distribution with a mean of 76 and a standard deviation of 30. Then we round the draws to integer values.
scores <- round(rnorm(300, mean = 76, sd = 30))

# Finally, we sample and store 20 exam scores, discarding values below 0 and above 100.
scores <- sample(scores[scores >= 0 & scores <= 100], 20)
```

Next, define a function to grade the vector of test scores using logical operators
to subset `score`:

```{r}
# Solution 1: Subsetting the vector of test scores
grade_score <- function(score, 
                           threshold_A = 90, 
                           threshold_B, 
                           threshold_C,
                           threshold_D){
  # target scores which fulfill the condition of being equal to or larger than
  # the threshold declared in "threshold_A" and replace the values with "A"
  score[score >= threshold_A] <- "A"
  # assign grade B to scores >= 80 & < 90
  score[score < threshold_A & score >= threshold_B] <- "B"
  # assign grade C to scores >= 70 & < 80
  score[score < threshold_B & score >= threshold_C] <- "C"
  # assign grade D to scores >= 60 & < 70
  score[score < threshold_C & score >= threshold_D] <- "D"
  # assign grade F to scores < 60
  score[score < threshold_D] <- "F"
  
  # output
  return(score)
}

cbind("Test score" = scores,
      # apply function and give a name "Grade" to the resulting vector of grades
      "Grade" = grade_score(scores, 
                               threshold_B = 80, 
                               threshold_C = 70, 
                               threshold_D = 60)
)

```


Alternatively, use logical operators with `ifelse()` functions:

```{r}
# Solution 2: Define function using repeated call to ifelse() function
grade_score <- function(score, threshold_A, threshold_B, threshold_C, threshold_D) {
  # assign grade A if test score is higher than threshold_A
  score <- ifelse(score >= threshold_A, "A", score)
  # else assign "B" if score is lower than threshold_A and higher than threshold_B
  score <- ifelse(score < threshold_A & score >= threshold_B, "B", score)
  # else assign "C" if score is lower than threshold_B and higher than threshold_C
  score <- ifelse(score < threshold_B & score >= threshold_C, "C", score)
  # else assign "D" if score is lower than threshold_C and higher than threshold_D
  score <- ifelse(score < threshold_C & score >= threshold_D, "D", score)
  # else assign "F" if score is lower than threshold D (if not, keep score)
  score <- ifelse(score < threshold_D, "F", no = score) 
  # or: if(score < threshold_d) { score <- "F"}
  
  # return 'score' vector as output
  return(score)
}

# Apply function
grade_score(scores, 
            threshold_A = 90,
            threshold_B = 80, 
            threshold_C = 70, 
            threshold_D = 60
)

```

**Hint:** Be CAREFUL! If instead of 

`ifelse(score < threshold_C & score >= threshold_D, "D", score)` 

you declare the value for the "else" (or "no") argument as `"F"`, e.g.: 

`ifelse(score < threshold_C & score >= threshold_D, "D", "F")`,

then you would replace all values that do not meet the conditions, 
i.e. all values 

(1) smaller than threshold_C AND
(2) greater than OR equal to threshold_D,

including previously assigned grade values "A", "B" and "C" because in `R`,
character values are defined as larger than any numeric values and:  

- `"Z"` \> `"Y"` \> `"A"` (larger to smaller in reverse alphabetical order),
- `"B"` > `"AA"` (first letter matters, not length of string),
- and `"B"` > `"b"`) (capital letter is larger than lowercase)
  
\  <!-- line break -->
